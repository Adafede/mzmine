<html>
	<head>
		<title>Peak detection - Deconvolution</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" type="text/css" href="/net/sf/mzmine/desktop/impl/helpsystem/HelpStyles.css">
    </head>

<body>

<h1>Chromatogram deconvolution</h1>

<h2>Description</h2>

<p>
Following the detection of chromatograms by the Chromatogram builder, chromatograms have to be deconvoluted into individual peaks.
The Deconvolution module provides several algorithms for this purpose.
</p>

<h4>Method parameters</h4>
<dl>
<dt>Suffix</dt>
<dd>This string is added to the end of the name of each processed peak list</dd>

<dt>Peak recognition</dt>
<dd>Selection of algorithm for peak recognition (see below)</dd>

<dt>Remove original peak list</dt>
<dd>If selected, the original chromatogram is automatically removed and only deconvoluted version will remain</dd>
</dl>


<h2>Peak recognition algorithms</h2>


<h3>Baseline cut-off</h3>

<p>
This method is very simple and useful to demonstrate the functionality of chromatogram deconvolution.
First, the algorithm removes the lowest part of the chromatogram below a baseline level specified by the user.
Remaining peaks which span above the baseline level are recognized if they fulfill the minimal requirements of height and length.
</p>

<h4>Method parameters</h4>

<dl>
<dt>Min peak height</dt>
<dd>Minimum acceptable height (intensity) for a chromatographic peak</dd> 
<dt>Min peak duration</dt>
<dd>Minimum acceptable length (time duration) for a chromatographic peak</dd>
<dt>Baseline level</dt>
<dd>Level below which all data points of the chromatogram are removed</dd>
</dl>

<p>
<img src="baseline_cutoff.png">
</p>

<h3>Noise amplitude</h3>

<p>
This method is suitable for chromatograms with significant background noise of varying intensity.
It works in a similar way as the Baseline cut-off method, but it sets the baseline level individually for each chromatogram, depending on the
amplitude of signal noise.
</p>

<p>
The baseline level is calculated as follows:<br>
1. The intensity range of the chromatogram is divided into bins of the user-specified size (the "Noise amplitude" parameter)<br>
2. The bin with the highest number of data points is found. This bin represents the intensity level of the noise signal.<br>
3. Baseline level is set equal to intensity of the bin with the most data points<br>
</p>

<p>
<img src="noiseAnalysis1.jpg">
<img src="noiseAnalysis2.jpg">
</p>


<h4>Method parameters</h4>

<dl>
<dt>Min peak height</dt>
<dd>Minimum acceptable height (intensity) for a chromatographic peak</dd> 
<dt>Min peak duration</dt>
<dd>Minimum acceptable length (time duration) for a chromatographic peak</dd>
<dt>Amplitude of noise</dt>
<dd>This value is the intensity amplitude of the signal in the noise region</dd> 
</dl>

<p>
<img src="noise_amplitude.png">
</p>


<h3>Savitzky-Golay</h3>

<p>
This method uses the Savitzky-Golay polynomial (A. Savitzky and M. J. E. Golay, Anal. Chem.,
 36, 1627 (1964)) to get the second smoothed derivative of the chromatogram intensities. The following 
 figure (left) presents the shape of a Gaussian peak (a), the first derivative (b), and the second 
 derivative (c). 
 The figure at right side shows how the signal (blue line) may be divided into individual 
 chromatographic peaks by observing the second derivative.
</p>

<p>
<img src="1nd2ndDerivative.jpg">
<img src="1nd2ndDerivative2.jpg">
</p>


<h4>Method parameters</h4>

<dl>
<dt>Min peak height</dt>
<dd>Minimum acceptable height (intensity) for a chromatographic peak</dd> 
<dt>Min peak duration</dt>
<dd>Minimum acceptable length (time duration) for a chromatographic peak</dd>
<dt>Derivative threshold level</dt>
<dd>Minimum acceptable intensity in the 2<sup>nd</sup> derivative for peak recognition</dd>

</dl>

<p>
<img src="savitzky_golay.png">
</p>


<h3>Local minimum search</h3>

<p>
This method is suitable for chromatograms with little noise and nice peak shapes. 
It searches for local minima in the chromatogram and separates individual peaks at these minimal points.
Individual peaks are recognized if they fulfill the minimal requirements of height and length.
The Chromatographic threshold parameter may be used if the chromatogram contains some background noise.
</p>


<h4>Method parameters</h4>

<dl>
<dt>Chromatographic threshold</dt>
<dd>Threshold for removing noise. The algorithm finds such intensity that given percentage of the chromatogram data points is below that intensity, and removes all data points below that level</dd>
 
<dt>Search minimum in RT range</dt>
<dd>If a local minimum is minimal in this range of retention time, it will be considered a border between two peaks</dd>

<dt>Minimum relative height</dt>
<dd>Minimum height of a peak relative to the chromatogram top data point</dd>

<dt>Minimum absolute height</dt>
<dd>Minimum absolute height of a peak to be recognized</dd>

<dt>Min ratio of peak top/edge</dt>
<dd>Minimum ratio between peak's top intensity and side (lowest) data points. This parameter helps to reduce detection of false peaks in case the chromatogram is not smooth.</dd>

</dl>

<p>
<img src="local_minimum_search.png">
</p>

</body>
</html>
