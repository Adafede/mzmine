<html>
    <head>
        <title>Alignment - RANSAC aligner</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" type="text/css" href="/net/sf/mzmine/desktop/helpsystem/HelpStyles.css">
    </head>

    <body>


        <h1>RANSAC peak list aligner</h1>
        <h2>Method overview</h2>
        <p>
            This method is an extension of the
            Join align method. The alignment of each sample is done against a
            master peak list which is taken from the first sample in the first
            round, and from the average of all aligned peak lists in every round.
            It corrects any linear or non-linear deviation in the retention time
            of the chromatograms by creating a model of this deviation.
        </p>

        <p>
            <img src="chromatogram.png" name="chromatograms">
        </p>

        <p>
            This picture shows an example of two samples with a non-linear deviation in the retention time.
        </p>

        <p>
            The "deviation" model for the retention time is created by taking some corresponding points from the peak list of two samples using RANSAC algorithm
            (<a HREF="http://en.wikipedia.org/wiki/RANSAC">http://en.wikipedia.org/wiki/RANSAC</a>) and using a non-linear regression method to fit the model.
        </p>

        <p>
            <img src="ransac_model.png" name="ransac model">
        </p>

        <p>
            This picture shows a preview of the
            model where the red dots represents the aligned peaks taken using
            RANSAC algorithm, and the blue line represents the fitted model using
            a non-linear regression.
        </p>

        <p>
            Using this model, the algorithm can
            predict the shift in the retention time along all the peak list and
            use the match score function, used also in Join Align algorithm, to
            match the peaks. This score is calculated based on the mass and
            retention time of each peak and ranges of tolerance stipulated in the
            parameters setup dialog.
        </p>

        <h4>Method parameters</h4>
        <dl>
            <dt>Peak list name</dt>
            <dd>This is the suffix to identify the new aligned peak list in Peak list frame of
                desktop.</dd>

            <dt>m/z tolerance</dt>
            <dd>This value sets the range, in terms of m/z, to verify for possible peak rows to be
                aligned. Maximum allowed m/z difference.</dd>

            <dt>Retention time tolerance after correction</dt>
            <dd>his value sets the range, in terms of retention time, to verify for possible peak rows to be aligned.
                Maximum allowed retention time difference.</dd>

            <dt>Retention time tolerance</dt>
            <dd>This value sets the range, in terms of retention time, to
                create the model using RANSAC and non-linear regression algorithm.
                Maximum allowed retention time difference.</dd>

            <dt>RANSAC Iterations</dt>
            <dd>Maximum number of
                iterations allowed in the algorithm to find the right model
                consistent in all the pairs of aligned peaks. When its value is 0,
                the number of iterations (k) will be estimate
                automatically.</dd>

            <dt>Minimum Number of Points</dt>
            <dd>% of points required to consider the model valid (d).</dd>

            <dt>Threshold value</dt>
            <dd>Threshold value (seconds) for determining when a data point fits a model (t).</dd>

            <dt>Linear model</dt>
            <dd>Sometimes the shift in the retention time between the peaks in the samples is
                not constant making that the model shape is non linear in some
                specific cases. This option should be selected only if the model has
                to be linear.</dd>
        </dl>

        <h4>Parameter setup dialog</h4>

        <p><img src="preview.png" name="graphics3" </p>

        <p>New aligned peak list showing peaks from 3 different samples.
            <br><br><img src="../../join/help/join_alignment_preview.jpg" name="alignment preview">
        </p>

    </body>
</html>


